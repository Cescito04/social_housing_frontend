(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2100:(e,t,r)=>{Promise.resolve().then(r.bind(r,4879))},4879:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5155),a=r(2115),n=r(5695),o=r(8508);function i(){let e=(0,n.useRouter)(),[t,r]=(0,a.useState)(null),[i,l]=(0,a.useState)(""),[c,u]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{if(l((0,o.J3)()),!(0,o.wR)())return void e.replace("/login");let t=(0,o.iD)(),s=t?function(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(e){return null}}(t):null;if(console.log("JWT payload:",s),r((null==s?void 0:s.role)||null),(null==s?void 0:s.role)==="proprietaire")return void e.replace("/maisons");u(!1)},[e]),c||"proprietaire"===t)?(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-tr from-blue-100 via-white to-blue-200",children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-600 mb-4",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),(0,s.jsx)("span",{className:"text-gray-700",children:"Redirection..."})]})}):(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-tr from-blue-100 via-white to-blue-200",children:(0,s.jsxs)("div",{className:"bg-white bg-opacity-95 p-8 rounded-2xl shadow-xl w-full max-w-md space-y-5 border border-gray-100 text-center",children:[(0,s.jsxs)("h1",{className:"text-3xl font-extrabold text-gray-900 mb-2",children:["Bienvenue ",i||"!"]}),(0,s.jsx)("p",{className:"text-gray-700",children:"Vous \xeates connect\xe9 \xe0 votre espace s\xe9curis\xe9."}),"locataire"===t&&(0,s.jsx)("a",{href:"/profile",className:"mt-4 inline-block bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition",children:"Voir mon profil"})]})})}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},8508:(e,t,r)=>{"use strict";r.d(t,{J3:()=>i,Lx:()=>a,iD:()=>n,ri:()=>c,ve:()=>o,wR:()=>l});let s={getItem:e=>localStorage.getItem(e),setItem:(e,t)=>{localStorage.setItem(e,t)},removeItem:e=>{localStorage.removeItem(e)}};async function a(e,t){let r=await fetch("http://localhost:8000/api/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok){let e="Identifiants invalides";try{let t=await r.json();e=t.detail||Object.values(t).join(" ")}catch(e){}throw Error(e)}let a=await r.json();s.setItem("access_token",a.access),s.setItem("refresh_token",a.refresh);let n=null;try{(n=JSON.parse(atob(a.access.split(".")[1])))&&n.username&&s.setItem("username",n.username),n&&n.first_name&&s.setItem("first_name",n.first_name)}catch(e){}return n}function n(){return s.getItem("access_token")}function o(){return s.getItem("refresh_token")}function i(){return s.getItem("first_name")||s.getItem("username")||""}function l(){return!!n()}function c(){s.removeItem("access_token"),s.removeItem("refresh_token"),s.removeItem("username"),s.removeItem("first_name")}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(2100)),_N_E=e.O()}]);